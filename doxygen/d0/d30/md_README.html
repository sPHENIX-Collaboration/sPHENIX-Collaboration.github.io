<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<title>Analysis Software: README</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script> <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script> 
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
	<div id="top">
		<!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><a href="https://wiki.bnl.gov/sPHENIX/index.php/Main_Page"><img
								alt="Logo" src="../../sphenix.png" /></a></td>
						<td style="padding-left: 0.5em;">
							<div id="projectname">
								Analysis Software
							</div> 
							<div id="projectbrief">
								Documentation for <a href="https://wiki.bnl.gov/sPHENIX/index.php/Main_Page">sPHENIX</a> simulation software
							</div> 
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Home&#160;page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../usergroup0.html"><span>External&#160;Links</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d0/d30/md_README.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Interface between sPHENIX and GenFit</p>
<p>This is the core-software respository for <a href="https://www.sphenix.bnl.gov/">sPHENIX collaboration</a>.</p>
<p><a href="https://web.racf.bnl.gov/jenkins-sphenix/job/sPHENIX/job/sPHENIX_CoreSoftware_MasterBranch/">![Build Status](https://web.racf.bnl.gov/jenkins-sphenix/buildStatus/icon?job=sPHENIX/sPHENIX_CoreSoftware_MasterBranch)</a> <a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/">![Doxygen](https://img.shields.io/badge/code%20reference-Doxygen-green.svg)</a></p>
<p><a href="https://github.com/sPHENIX-Collaboration/coresoftware/issues">![Open Issues](https://img.shields.io/github/issues/sPHENIX-Collaboration/coresoftware.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/coresoftware/pulls">![Open Pull Request](https://img.shields.io/github/issues-pr/sPHENIX-Collaboration/coresoftware.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/coresoftware/commits/master">![Monthly Commits](https://img.shields.io/github/commit-activity/m/sPHENIX-Collaboration/coresoftware.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/coresoftware/commits/master">![Last Commit](https://img.shields.io/github/last-commit/sPHENIX-Collaboration/coresoftware.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/coresoftware/archive/master.zip">![Download size](https://img.shields.io/github/languages/code-size/sPHENIX-Collaboration/coresoftware.svg)</a></p>
<p>Code from the <code>master</code> branch is pulled and build each night (nightly-build) and it becomes <a href="https://wiki.bnl.gov/sPHENIX/index.php/Setup#.28At_each_login.29_Run_sPHENIX_login_shell">part of the default software environment on RCF</a>. Weekly snapshot of the build is also available as ANA-builds.</p>
<p>Due to its importance, update of this repository require going through a review via <a href="https://wiki.bnl.gov/sPHENIX/index.php/GitHub_Coresoftware_Update_Procedures">the "Pull Request" process</a>. New pull requests will be automatically checked with the <a href="https://web.racf.bnl.gov/jenkins-sphenix/">sPHENIX Jenkins continuous integration</a>. At the end of the check, a report will be posted back to the corresponding pull request thread.</p>
<h1>Useful links</h1>
<ul>
<li>Tutorials<ul>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/SPHENIX_software_day-1_checklist">Get started on day-1</a></li>
<li><a href="https://github.com/sPHENIX-Collaboration/macros">sPHENIX macros that run this core-software</a></li>
<li><a href="https://github.com/sPHENIX-Collaboration/tutorials">Tutorial for sample code on simulation</a></li>
<li><a href="https://github.com/sPHENIX-Collaboration/Singularity">Run sPHENIX software anywhere with container</a></li>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/GitHub_Coresoftware_Update_Procedures">"Pull Request" tutorial to update this repository</a></li>
</ul>
</li>
<li>Documentation<ul>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/Software">Software wiki</a></li>
<li><a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/">Doxygen: easier way to browse code</a></li>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/Example_of_using_DST_nodes#Building%20a%20package">Build a package</a></li>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/Codingconventions#Coding_Convention">Coding convention</a></li>
</ul>
</li>
<li>Communication<ul>
<li><a href="https://indico.bnl.gov/categoryDisplay.py?categId=88">Simulation and software meeting series</a></li>
<li><a href="https://lists.bnl.gov/mailman/listinfo/sphenix-github-l">Discussion on this repository</a> <hr/>
</li>
</ul>
</li>
</ul>
<p><a href="https://www.sphenix.bnl.gov/">![logo](https://raw.githubusercontent.com/sPHENIX-Collaboration/utilities/master/jenkins/material/sphenix-logo-white-bg-72p.png)</a></p>
<p>Please find instruction at <a href="https://wiki.bnl.gov/sPHENIX/index.php/Plot_template">https://wiki.bnl.gov/sPHENIX/index.php/Plot_template</a> . Here is a snapshot:</p>
<h1>How to use</h1>
<p>To ensure some consistency among plots produced by different sPHENIX members, a candidate style file is being proposed (May 2017), based on the ATLAS style file. Please click here for the gzipped tar file. For general use, copy or link the <code>sPHENIXStyle.h</code> and <code>sPHENIXStyle.C</code> files somewhere, either locally or in your macro path (<code>gROOT-&gt;GetMacroPath()</code> will tell you, and add it in <code>.rootrc</code> if you need one). Then do ``` [0] gROOT-&gt;LoadMacro("sPhenixStyle.C") [1] <a class="el" href="../../d1/d95/sPhenixStyle_8C.html#a40c9ca7bea26e6a08182ceb8298869e7" title="sPHENIX Style, based on a style file from ATLAS by Peter Steinberg">SetsPhenixStyle()</a> [2] .x test_style.C // give it a try <code> and you're good to go (even better, add this all into your</code>.rootlogon.C``` file)</p>
<h1>Rules of the sPHENIX style</h1>
<ul>
<li>Don't talk about the style file.</li>
<li>Always use the style file.</li>
<li>Units should always be indicated in brackets "[ ]", while counts will typically specify the bin width "Events / 2 GeV" or "Events / 0.13 rad".</li>
<li>Every plot should have a legend indicating "sPHENIX", "sPHENIX Preliminary", "sPHENIX Simulation", etc.</li>
<li>sPHENIX should be bold, italic</li>
<li>Where possible, indicate the system being considered and it's energy</li>
<li>"MC" predictions should be filled, with distinguishable colors</li>
<li>Data or pseudodata should always be histograms or graphs with error bars</li>
<li>Elements should never overlap, with each other or with the axis</li>
</ul>
<p>This is the standard macros respository for <a href="https://www.sphenix.bnl.gov/">sPHENIX collaboration</a>. Following is the 10-min tutorial on using the sPHENIX macros from <a href="https://wiki.bnl.gov/sPHENIX/index.php/Tutorial/sPHENIX_simulation">this wiki link</a>.</p>
<p><a href="https://web.racf.bnl.gov/jenkins-sphenix/job/sPHENIX/job/sPHENIX_CoreSoftware_MasterBranch/">![Build Status](https://web.racf.bnl.gov/jenkins-sphenix/buildStatus/icon?job=sPHENIX/sPHENIX_CoreSoftware_MasterBranch)</a> <a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/">![Doxygen](https://img.shields.io/badge/code%20reference-Doxygen-green.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/macros/issues">![Open Issues](https://img.shields.io/github/issues/sPHENIX-Collaboration/macros.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/macros/pulls">![Open Pull Request](https://img.shields.io/github/issues-pr/sPHENIX-Collaboration/macros.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/macros/commits/master">![Monthly Commits](https://img.shields.io/github/commit-activity/m/sPHENIX-Collaboration/macros.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/macros/commits/master">![Last Commit](https://img.shields.io/github/last-commit/sPHENIX-Collaboration/macros.svg)</a></p>
<h1>Get started</h1>
<p>Please follow <a href="https://wiki.bnl.gov/sPHENIX/index.php/SPHENIX_software_day-1_checklist">SPHENIX software day-1 checklist</a> to get started on <a href="https://www.racf.bnl.gov/">RHIC computing facility at BNL</a>, or follow the <a href="https://github.com/sPHENIX-Collaboration/Singularity">sPHENIX container setup</a> for your own computing environment.</p>
<h1>Check out macro repository</h1>
<p>Download the newest macro repository from GitHub:</p>
<p>``` [jinhuang test]$ git clone <a href="https://github.com/sPHENIX-Collaboration/macros.git">https://github.com/sPHENIX-Collaboration/macros.git</a> Cloning into 'macros'... remote: Counting objects: 1125, done. remote: Total 1125 (delta 0), reused 0 (delta 0), pack-reused 1125 Receiving objects: 100% (1125/1125), 181.75 KiB | 0 bytes/s, done. Resolving deltas: 100% (471/471), done. Checking connectivity... done. [jinhuang test]$ cd macros/macros/g4simulations/ [jinhuang g4simulations]$ # here is all the macros to run fsPHENIX and sPHENIX simulations ```</p>
<p>The default sPHENIX simulation + reconstruction macro is <a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/d5/d2c/macros_2blob_2master_2macros_2g4simulations_2Fun4All__G4__sPHENIX_8C_source.html#l00001">Fun4All_G4_sPHENIX.C</a>, which is self-explanatory. It is not a black box!. You are welcome to open/edit it to work for your purpose of study.</p>
<h1>Try an event display</h1>
<p>Then let's see what is implemented by firing up one event: ``` [jinhuang macros]$ source /opt/sphenix/core/bin/sphenix_setup.csh -n # setup sPHENIX environment if not already done so </p>
<h1>Note, for bash users, please use /opt/sphenix/core/bin/sphenix_setup.sh instead</h1>
<p>[jinhuang macros]$ root root [] .x Fun4All_G4_sPHENIX.C(-1) // here negative value in event number start an event display of one event root [] .L DisplayOn.C root [] PHG4Reco* g4 = <a class="el" href="../../dd/d76/macros_2blob_2master_2macros_2g4simulations_2DisplayOn_8C.html#a8ac4d6fb78f920957b354f88d6195f54">DisplayOn()</a> root [] <a class="el" href="../../da/d29/classFun4AllServer.html">Fun4AllServer</a> *se = <a class="el" href="../../da/d29/classFun4AllServer.html#a3e55156f91b2c94bb6c4ef33ffce587a">Fun4AllServer::instance()</a>; root [] se-&gt;run(1) root [] <a class="el" href="../../dd/d76/macros_2blob_2master_2macros_2g4simulations_2DisplayOn_8C.html#ac24d1b820bb16d04729725317c86b234">displaycmd()</a> # this one show more Geant4 command we can run from the <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> prompt ```</p>
<h1>Run more events</h1>
<p>This is simpler, just run with first parameter as the intended number of event: ``` [jinhuang macros]$ source /opt/sphenix/core/bin/sphenix_setup.csh -n # setup sPHENIX environment if not already done so [jinhuang macros]$ root root [] .x Fun4All_G4_sPHENIX.C(10) // run 10 events ```</p>
<h1>What next?</h1>
<p>Now you are able to run the whole sPHENIX simulation + reconstruction chain. Many next-step topics are listed in the <a href="https://wiki.bnl.gov/sPHENIX/index.php/Software">software</a> page. And specifically, to use the simulation for your study, a few thing you might want to try:</p>
<ul>
<li>Checkout the <a href="https://wiki.bnl.gov/sPHENIX/index.php/Tracking">evaluator Ntuples</a> output from your 10 events for a generic look of the reconstructed data.</li>
<li>Run <a href="https://github.com/sPHENIX-Collaboration/tutorials">sPHENIX software tutorials</a>.</li>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/Example_of_using_DST_nodes">Write your analysis module for more dedicated analysis</a>, for which the module produced the evaluator NTuple (<a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/dd/d59/classCaloEvaluator.html">CaloEvaluator</a>, <a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/d1/df4/classJetEvaluator.html">JetEvaluator</a>, <a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/d6/d11/classSvtxEvaluator.html">SvtxEvaluator</a>) can usually serve as good examples.</li>
</ul>
<p>Compile:</p>
<p>g++ <code>root-config --cflags --glibs</code> -L$OFFLINE_MAIN/lib -I$OFFLINE_MAIN/include -leicsmear -lCGAL -lfastjet fill_jet_tree.C -ofill_jet_tree</p>
<p>Run:</p>
<p>./fill_jet_tree data/pythiaeRHIC/TREES/pythia.ep.20x250.RadCor=0.Q2gt1.50kevts.root data/pythiaeRHIC/TREES/pythia.ep.20x250.RadCor=0.Q2gt1.50kevts.smear.root jettest.root</p>
<p>Truth level B Di-jet events for investigating mometum imbalance</p>
<h1>Some notes for Di b-jet study</h1>
<p>CMS conference note: <a href="http://cds.cern.ch/record/2202805/files/HIN-16-005-pas.pdf">http://cds.cern.ch/record/2202805/files/HIN-16-005-pas.pdf</a></p>
<p>Useful table: 4.1 (pg146) sPHENIX proposal</p>
<p>Plots: Like Fig. 10 from CMS Also Fig. 2.2 from sPHENIX proposal (pg56)</p>
<h2>sPHENIX luminosity</h2>
<p>&ndash; p+p &ndash; 175 pb^-1</p>
<p>&ndash; Au+Au &ndash; 10B events for 0-10% in |z|&lt;10 &lt;Ncoll&gt;(0-10%) = 962 AuAu luminosity = 10e9 / 6.8e9 nb = 1.47 nb^-1 (For comparison Run 14 AuAu 200 was 43.9 nb^-1, or ~1.27 pb^-1 for 0-10%)</p>
<p>equivelant nn luminosity: N_{evt}^{NN} / sigma_NN = N_{evt}^{AA}*Ncoll / sigma_NN = 10e9 * 962 / 42e9 pb = 229 pb^-1</p>
<p>Use RAA(b-jet)=0.6 (additional inefficiency per jet)</p>
<h2>Running sims</h2>
<p>BJet analysis by counting high DCA tracks, originally developped by Dennis V. Perepelitsa</p>
<p>Please add new subfolder here for modules used in HF hadron reconstruction and analysis.</p>
<p>The <a href="https://github.com/sPHENIX-Collaboration/analysis/tree/master/ParticleID/RICHAnalysis">main library for RICH analysis</a> (which I think should include ALL Cerenkov PID detectors):</p>
<ul>
<li><a class="el" href="../../dd/d15/classFastPid__RICH.html">FastPid_RICH</a>: Fun4All module that should contain the fast simulation / parametrization- right now it extrapolates charged tracks to the gas RICH volume and assigns PID's based on some simple eta and momentum cut and the true PID. It needs work to implement the actual parametrization, but all the input / output calls should be there. This class would need to be copied and adapted for FastPid_mRICH and FastPid_DIRC.</li>
<li><a class="el" href="../../d6/da3/classTrackProjectorPid.html">TrackProjectorPid</a>: Helper class to do track projections to spheres, planes, and cylinders.</li>
<li><a class="el" href="../../d2/d0f/classPidInfo.html">PidInfo</a> and <a class="el" href="../../dc/d4f/classPidInfoContainer.html">PidInfoContainer</a>: Class that stores both track ID and PID information, and the corresponding container class</li>
<li><a class="el" href="../../dc/d11/classRICHParticleID.html">RICHParticleID</a>: Fun4All module that calls the IRT algorithm (using Alessio's implementation) to calculate Cerenkov angels for tracks and photon hits from the gas RICH</li>
</ul>
<p><a href="https://github.com/sPHENIX-Collaboration/analysis/tree/master/ParticleID/RICHAnalysis_macros/macros_fun4all">Fun4All macros</a> for running:</p>
<ul>
<li>Fun4All_G4_EICDetector_RICH.C: Run a reduced version of the Geant4 simulation (omitting all calorimeters to speed up the processing)</li>
<li>Fun4All_RICHReco.C: Macro calling the RICH reconstruction with a boolean to switch between "FastSim" and hit/IRT based reconstruction</li>
</ul>
<p>This analysis package has two modules associated with it. <a class="el" href="../../dc/d53/classPhotons.html">Photons</a> identifies single photons and <a class="el" href="../../d7/dec/classForward__pi0s.html">Forward_pi0s</a> identifies netural pions in either the fsPHENIX arm or central arm (despite it's name, it can do both arms).</p>
<p>It can run with the default Fun4All_G4_sPHENIX.C or Fun4All_G4_fsPHENIX.C macro. The packages are only designed to run for single (or multi) particle simulations. The output trees are simply trees with either single photons or pi0 characteristics, with the truth information stored in the tree.</p>
<p>The analysis packages can be used with the following steps:</p>
<ol type="1">
<li>Execute the usual <code>autogen.sh</code> and <code>make install</code> building of the <a class="el" href="../../dc/d53/classPhotons.html">Photons</a> package, per the usual sPHENIX way.</li>
</ol>
<ol type="1">
<li>Include the following lines of code in the Fun4All_G4_sPHENIX.C macro: ``` gSystem-&gt;Load("libPhotons.so"); <a class="el" href="../../dc/d53/classPhotons.html">Photons</a> *photons = new <a class="el" href="../../dc/d53/classPhotons.html">Photons</a>("outputfilename.root"); se-&gt;registerSubsystem(photons); ``` where se is the <a class="el" href="../../da/d29/classFun4AllServer.html">Fun4AllServer</a> instantiated at the beginning of the macro.</li>
</ol>
<p>The outputfile will have the name "outputfilename.root" and have several trees in it, which are named based on their contents.</p>
<h2>Embedding capabilities</h2>
<p>The package was modified to run in HIJING embedded backgrounds. One simply needs to turn the switch on in the package: ``` photons-&gt;use_embedding(1); //1 == use embedding, 0 == don't use it ``` One may need to also set the appropriate embedding flags in the actual Fun4All macro as well</p>
<p>This analysis package is designed to be run over with the main sPHENIX G4 macro, Fun4All_G4_sPHENIX.C. When written, it was made to be run over dedicated PYTHIA direct photon-jet events that were output into HEPMC format, although in principle any input that works with Fun4All_G4_sPHENIX.C should work. The standard "generic" PYTHIA triggers can be used to generate events, i.e. the <a class="el" href="../../d9/d8b/classPHPy8ParticleTrigger.html">PHPy8ParticleTrigger</a> set to find photons and the <a class="el" href="../../d7/d30/classPHPy8JetTrigger.html">PHPy8JetTrigger</a> set to find jets of your choosing.</p>
<p>In order to run the macro and include the <a class="el" href="../../dc/d65/classPhotonJet.html">PhotonJet</a> analysis package, the following steps should be taken:</p>
<ol type="1">
<li>Execute the usual <code>autogen.sh</code> and <code>make install</code> building of the <a class="el" href="../../dc/d65/classPhotonJet.html">PhotonJet</a> package, per the usual sPHENIX way.</li>
</ol>
<ol type="1">
<li>Include the following lines of code in the Fun4All_G4_sPHENIX.C macro: ``` gSystem-&gt;Load("libPhotonJet.so"); <a class="el" href="../../dc/d65/classPhotonJet.html">PhotonJet</a> * photjet = new <a class="el" href="../../dc/d65/classPhotonJet.html">PhotonJet</a>("outputfilename.root"); se-&gt;registerSubsystem(photjet); ``` where se is the <a class="el" href="../../da/d29/classFun4AllServer.html">Fun4AllServer</a> instantiated at the beginning of the macro.</li>
</ol>
<p>The output is then "outputfilename.root" and contains several trees which have the relevant information. The tree names should be reasonably self explanatory. Note that truth information for the photon-jet correlated pairs is located directly in that tree, i.e. in the tree "isophoton-jets" the truth jet pt for a given entry is _truthjetpt and the reconstructed jet pt is _recojetpt.</p>
<p>Of course one can add whatever they would like to the file PhotonJet.C to add leaves to these trees or any other thing they see fit. Happy photon-jetting!</p>
<h2>More detailed things (will continue adding as code develops)</h2>
<p>There are a few public functions that one can set automatically, for example the minimum photon pT cut or the isolation cone size. The isolation cone algorithm is by default used; one can change this with the function use_isocone_algorithm. The isolation algorithm details are in the code, but it currently checks for reconstructed tracks and clusters within a cone size radius set by the user greater than 200 MeV in pT. One can also change the cone size used for the jets. The default size is R=0.3, and the DSTnodes can accomodate R=0.2 to R=0.8 in increments of 0.1.</p>
<p>There are two different truth trees; one is produced with the node "PHG4TruthInfoContainer" and the other is from the raw HEPMC files, i.e. the tree "truthtree" contains all of the PYTHIA output which includes parton info while the "truth_g4particles" is a more condensed truth tree without the parton information.</p>
<p>Additional functionality has been added to look at forward jets. Tracked jet capabilities were added as well; one can set the use of these in their macro.</p>
<p>One can additionally choose to use or not use the position correction in the CEMC via the flag use_positioncorrection_CEMC. For pure photon measurements this should be used as it improves the resolution on the constant energy term of the photon by 1-2%</p>
<h2>Addition of HIJING embedding capabilities</h2>
<p>In order to produce photon-jets in heavy ion background environments, PYTHIA events can be embedded into HIJING hits files. The code has been updated to include these capabilities; notably the flag "set_AA_collisions" must be set to 1 in order to grab the correct nodes from the node tree. This is because the jets undergo a background subtraction method, and this is put onto a different node. If you want regular pp capabilities, then just set this flag to 0 and it will get the usual tower-jet nodes.</p>
<h2>Additional code packages</h2>
<p>There are two additional code packages, <a class="el" href="../../dc/d53/classPhotons.html">Photons</a> and <a class="el" href="../../d9/de3/classTruthPhotonJet.html">TruthPhotonJet</a>. <a class="el" href="../../dc/d53/classPhotons.html">Photons</a> is a similar analysis package to <a class="el" href="../../dc/d65/classPhotonJet.html">PhotonJet</a> with less of the overhead and is intended to be used with a single photon generator. <a class="el" href="../../d9/de3/classTruthPhotonJet.html">TruthPhotonJet</a> is also similar to <a class="el" href="../../dc/d65/classPhotonJet.html">PhotonJet</a> but is intended to be used only with truth PYTHIA information. The purpose is to quickly generate and analyze truth PYTHIA events to determine e.g. the pT/eta reach of jets/photons, etc.</p>
<p>Analysis repository hosting <a href="https://wiki.bnl.gov/sPHENIX/index.php/Example_of_using_DST_nodes">user modules that analyze the sPHENIX simulation and data</a>.</p>
<p><a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/">![Doxygen](https://img.shields.io/badge/code%20reference-Doxygen-green.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/analysis/commits/master">![Monthly Commits](https://img.shields.io/github/commit-activity/m/sPHENIX-Collaboration/analysis.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/analysis/commits/master">![Last Commit](https://img.shields.io/github/last-commit/sPHENIX-Collaboration/analysis.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/analysis/archive/master.zip">![Download size](https://img.shields.io/github/languages/code-size/sPHENIX-Collaboration/analysis.svg)</a></p>
<p>This repository is read/writabled to the "Collaborator" team. It is equivalent to the PHENIX CVS path of</p>
<ul>
<li>offline/analysis/</li>
<li>offline/AnalysisTrain/</li>
</ul>
<p>Welcome to push your analysis code directly to the master branch. No pull request procedure required. Once on GitHub, your code will be nightly compiled into the sPHENIX software reference website: <a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/index.html">https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/index.html</a></p>
<p>This folder is a collection of modules used for testing purpose.</p>
<p>Exploration and comparison for streaming clustering algorithm development by Ivan Kotov <a href="#" onclick="location.href='mai'+'lto:'+'kot'+'ov'+'@bn'+'l.'+'gov'; return false;">kotov<span style="display: none;">.nosp@m.</span>@bnl<span style="display: none;">.nosp@m.</span>.gov</a></p>
<p>Copied from <a href="https://www.phenix.bnl.gov/viewvc/viewvc.cgi/phenix/offline/analysis/groot">https://www.phenix.bnl.gov/viewvc/viewvc.cgi/phenix/offline/analysis/groot</a> Credit: hemmick vzakharov nivram isibf5y</p>
<h1>It copies cluster and jet objects and makes new ones for the purpose of eventually applying different energy scales based on constituents</h1>
<h2>These are the main analysis files</h2>
<table class="doxtable">
<tr>
<th>File name </th><th>description</th></tr>
<tr>
<td>TreeMaker.C </td><td>class implementation file </td></tr>
<tr>
<td><a class="el" href="../../d2/d04/TreeMaker_8h.html">TreeMaker.h</a> </td><td>class header file </td></tr>
<tr>
<td>TreeMakerBackgrounds.C </td><td>gets tower backgrounds and sets class variables (for tree output, holdover from DVP's code) </td></tr>
<tr>
<td>TreeMakerCopyAndMakeClusters.C </td><td>copies existing cluster object and fills a new one, algorithm will go here </td></tr>
<tr>
<td>TreeMakerCopyAndMakeJets.C </td><td>copires existing jet objects and makes a new one, algorithm will go here </td></tr>
<tr>
<td>TreeMakerCreateNode.C </td><td>creates new nodes for CopyAndMake functions to fill </td></tr>
<tr>
<td>TreeMakerGetJets.C </td><td>gets jets and sets class variables (for tree output) </td></tr>
<tr>
<td>TreeMakerInitializations.C </td><td>initializes the tree and class variables </td></tr>
<tr>
<td><a class="el" href="../../da/d75/TreeMakerLinkDef_8h.html">TreeMakerLinkDef.h</a> </td><td>standard LinkDef (<a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a>) </td></tr>
<tr>
<td>TreeMakerUseFastJet.C </td><td>applies fast jet algorithm to list of clusters, regular and modified </td></tr>
</table>
<h2>Additional basic PHENIX universe files</h2>
<table class="doxtable">
<tr>
<th>File name </th><th>description</th></tr>
<tr>
<td>Makefile.am </td><td>standard makefile </td></tr>
<tr>
<td>autogen.sh </td><td>standard autogen file </td></tr>
<tr>
<td>configure.in </td><td>standard configure file </td></tr>
</table>
<h2>Macros to test the code</h2>
<table class="doxtable">
<tr>
<th>File name </th><th>description</th></tr>
<tr>
<td>run_macro.C </td><td>macro to run this class </td></tr>
<tr>
<td>run_macro_2.C </td><td>additional macro </td></tr>
</table>
<h2>Additional files</h2>
<p>File name | description ------&mdash; | --------&mdash;</p>
<p>This package is intended to demonstrate some basic features of analysis tutorials and walk a new user through building a package, extracting physics information from the NodeTree, and then using that package to produce a root file that can be used for further analysis. The package demonstrates some basic features and contains some useful code for extracting physics information like reconstructed tracks, reconstructed EMCal clusters, and truth particle information (amongst some other things).</p>
<h2>Building The Package</h2>
<p>The first step to running the tutorial is to build the analysis package from src. Follow these instructions:</p>
<p>```bash $ cd src $ mkdir build $ cd build $ ../autogen.sh &ndash;prefix=$MYINSTALL $ make $ make install ```</p>
<p>Here, this assumes that you have set an environment variable <code>$MYINSTALL</code> that points to your install directory. For example, <code>$ echo $MYINSTALL</code> returns <code>/home/vagrant/install</code> for me, where the install directory is set on my virtual machine when running the Singularity container. The install directory can be wherever you like, but it is generally good practice to have one where all of your installation libraries will live.</p>
<p>You should also make sure that your <code>$LD_LIBRARY_PATH</code> and <code>$ROOT_INCLUDE_PATH</code> point to the correct place for your install directory. See <a href="https://wiki.bnl.gov/sPHENIX/index.php/Example_of_using_DST_nodes">here</a> and <a href="https://wiki.bnl.gov/sPHENIX/index.php/Sphenix_root6">here</a> for more details. You can use the following script to do this for you:</p>
<p>```bash source /opt/sphenix/core/bin/setup_local.csh $MYINSTALL ```</p>
<h2>Running the example macro</h2>
<p>The example macro, found in <code>macro/Fun4All_AnaTutorial.C</code>, is just the default <code>Fun4All_G4_sPHENIX.C</code> macro with the <a class="el" href="../../d0/da9/classAnaTutorial.html" title="Definition of this analysis module class.">AnaTutorial</a> package added to it. If you would like to see how the default macro and this macro are different, you can just open <code>Fun4All_AnaTutorial.C</code> in your favorite text editor and search for <code>anatutorial</code>, or run a <code>diff</code> command on the two files.</p>
<p>Running the macro requires the rest of the sPHENIX macro repository. If you have already cloned it from git, you can simply do</p>
<p>``` $ cp Fun4All_AnaTutorial.C /the/path/to/macros/macros/g4simulations ```</p>
<p>and then run <code>$ root -l Fun4All_AnaTutorial.C</code>. Otherwise, first clone the macros repository as directed <a href="https://wiki.bnl.gov/sPHENIX/index.php/Code_Repository">here</a>, and then move the macro to your newly cloned <code>macros</code> directory.</p>
<p>This macro displays the output of various event generators. The input is selected by true/false switches. It is set to pythia6 as default. If <a class="el" href="../../d1/d98/namespaceHepMC.html">HepMC</a> files or EIC TTree file input is selected the filename has to be given as second argument. By default the first event is displayed. The visualization macro contains a bunch of commented out options you may play with (after reading the GEANT4 docs). Usage:</p>
<p>root.exe</p>
<p>.x Fun4All_Generator_Display.C()</p>
<p>Small example of an Ion Gun shooting at a block of material Usage: // set up the environment: source /opt/sphenix/core/bin/phenix_setup.csh -n</p>
<p>// start root root.exe</p>
<p>// Run the default macro (10 events by default, argument is number of events) .x Fun4All_G4_IonGun.C</p>
<p>the energy deposition is saved in an ntuple in G4EdepNtuple.root which contains the summed up energy deposited in the volume (separated by layers if implemented) as well as the sum over the layers (layer = -1 for this).</p>
<p>Use the Display:</p>
<p>.x Fun4All_G4_IonGun.C(0) .L DisplayOn.C <a class="el" href="../../d0/d78/classPHG4Reco.html" title="Runs G4 as a subsystem.">PHG4Reco</a> *g4 = <a class="el" href="../../dd/d76/macros_2blob_2master_2macros_2g4simulations_2DisplayOn_8C.html#a8ac4d6fb78f920957b354f88d6195f54">DisplayOn()</a></p>
<p>// get pointer to framework <a class="el" href="../../da/d29/classFun4AllServer.html">Fun4AllServer</a> *se = <a class="el" href="../../da/d29/classFun4AllServer.html#a3e55156f91b2c94bb6c4ef33ffce587a">Fun4AllServer::instance()</a>; // run one event se-&gt;run(1);</p>
<p><a class="el" href="../../dd/d76/macros_2blob_2master_2macros_2g4simulations_2DisplayOn_8C.html#ac24d1b820bb16d04729725317c86b234">displaycmd()</a> gives some useful drawing commands</p>
<p>Modifying the Ion Gun:</p>
<p>// get a pointer to the ion gun <a class="el" href="../../da/ddc/classPHG4IonGun.html">PHG4IonGun</a> *gun = <a class="el" href="../../d3/d64/tutorials_2blob_2master_2block_2DisplayOn_8C.html#aac5b91de18e6005ee617060b3dde4b0b">getgun()</a></p>
<p>// print current setting: gun-&gt;<a class="el" href="../../db/d5d/test__style_8C.html#aa587a93d9563c8d433bd1736432c4acd">Print()</a></p>
<p>This is an example <a href="https://github.com/sPHENIX-Collaboration/">sPHENIX</a> <a href="https://root.cern.ch/notebooks/HowTos/HowTo_ROOT-Notebooks.html">ROOT Jupyter Notebook</a> to run the sPHENIX anaysis on the <a href="https://jupyter.sdcc.bnl.gov/">BNL SDCC Jupyter Lab</a>.</p>
<p><a href="https://jupyter.sdcc.bnl.gov/jupyterhub/htc"></a></p>
<p>Starting from <a href="https://jupyter.sdcc.bnl.gov/jupyterhub/htc">https://jupyter.sdcc.bnl.gov/jupyterhub/htc</a> ( = <code>lauch</code> button on the <b>HTC</b> Jupyter hub) for this tutorial, the username / password is the same for your BNL RCF / SDCC account. At the 1st time login, SDCC will ask you to setup a two factor anthentication, such as using Google Authenticator (<a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&amp;hl=en_US">Android</a>/<a href="https://apps.apple.com/us/app/google-authenticator/id388497605">iPhone</a>).</p>
<p>Jupyter Notebook provide an analysis interface that can integrate documentation, code and output plot in a single file. It supports all sPHENIX environment and most sPHENIX macros. It is suitable for final analysis step, while large scale analysis and reconstruction should go through the compiled <code>c++</code> analysis module.</p>
<p>Two examples are provided in this tutorial, one for each supported sPHENIX Jupyter kernels:</p>
<ul>
<li><code>sPHENIX <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> C++</code> kernel: An analysis in <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> <code>C++</code> macros: <a href="../.././example_tpc_testbeam2019_root.ipynb">example_tpc_testbeam2019_root.ipynb</a></li>
<li><code>Python (sPHENIX)</code> kernel: <code>pyROOT</code> macro perform similar task if you would like to use <code>python</code> for analysis: <a href="../.././example_tpc_testbeam2019_python.ipynb">example_tpc_testbeam2019_python.ipynb</a></li>
</ul>
<p>Welcome to download either of them and run from the JupyterLab interfance. Also welcome to make a new notebook, during which please select one of these two kernels, which carry the most recent sPHENIX software environment on SDCC/RACF. Notebooks can be previewed on GitHub, and edited/run on <a href="https://jupyter.sdcc.bnl.gov/">BNL SDCC Jupyter Lab</a>.</p>
<p>The JupyterLab interface can also be launched on your computer/local computing cluster via <a href="https://github.com/sPHENIX-Collaboration/Singularity">sPHENIX Singularity Container</a>. Instruction to come, and please contact Jin Huang if you would like to try early releases.</p>
<p>How to use: start root and Run the Fun4All_G4_sPHENIX.C (or fsPHENIX or ePHENIX) macro with -1 events (which just loads the G4 configuration). You'll need a lot of sub-macros, you definitely want to run this in another directory.</p>
<p>.x Fun4All_G4_sPHENIX.C(-1)</p>
<p>Load the matscan.C macro</p>
<p>.L matscan.C</p>
<p>and set the theta/phi ranges and number of bins you want with</p>
<p><a class="el" href="../../d9/d1d/matscan_8C.html#a72f854a42b78df4a1acdb7adfea33a83">set_phimin()</a> // in degrees <a class="el" href="../../d9/d1d/matscan_8C.html#ab2c3b5d8fffbcda789c27f82bb2e27a2">set_phispan()</a> // in degrees, phi range is phimin - phimin+phispan <a class="el" href="../../d9/d1d/matscan_8C.html#a683a75fb48b41836b84f87b8e03749d2">set_phibins()</a> // number of bins in this phi range</p>
<p>same for theta. For scans in phi use theta_span = theta_min and theta_bins = 1, for midrapidity scans you can use the <a class="el" href="../../d9/d1d/matscan_8C.html#a29d78022af7511781a7dbc7723285f41">setmidrap()</a>; to set this up</p>
<p>For scans in theta use phi_span = phi_min and phi_bins = 1, use <a class="el" href="../../d9/d1d/matscan_8C.html#ae92b274aef867d4375b83a0b77647608">set_thetascan()</a> to do a scan in theta.</p>
<p>if you are running the same ranges all the time, just adjust those values in the macro. Execute <a class="el" href="../../d9/d1d/matscan_8C.html#a98ccbc6135fead542f3c4d1dd6882d63">matscan()</a> and store output in some file (here T.T), for Root5 use:</p>
<p><a class="el" href="../../d9/d1d/matscan_8C.html#a98ccbc6135fead542f3c4d1dd6882d63">matscan()</a>; &gt; T.T</p>
<p>Root6: uses a slightly different scheme, you need to redirect all output (at which time you will not see any prompt anymore - genius) .&gt; T.T <a class="el" href="../../d9/d1d/matscan_8C.html#a98ccbc6135fead542f3c4d1dd6882d63">matscan()</a> .q</p>
<p>Sadly this dumps more than just the x0/lamda values for each phi/theta bin. In order to extract those, quit root and run matscan_digest.pl to extract x0/lamda0 for each phi/theta bin:</p>
<p>perl matscan_digest.pl T.T</p>
<p>This will create a file matscan.dat. plot_matscan.C is a simple plotting macro which plots x0/lamda vs phi (leave theta constant by theta_span = theta_min and theta_bins = 1:</p>
<p>.x plot_matscan.C("matscan.dat")</p>
<p>If you want to plot theta (keeping phi constant when running matscan.C), use</p>
<p>.x plot_matscan.C("matscan.dat",1)</p>
<p>This is an example analys module which iterates through reconstructed jet, matches it with truth jet, and matches with reconstructed tracks within a dR cone. The output is a <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> file with histograms of reconstructed jet sepectrum and a TTree with per-jet kinematics and matched truth jet kinematics. The matched track pT and Delta-R is also saved in an array in the TTree.</p>
<h2>Compile this module</h2>
<p>To compile this module, please follow instruction of <a href="https://wiki.bnl.gov/sPHENIX/index.php/Example_of_using_DST_nodes#Building_a_package">building a package</a>,</p>
<p>After compiling, it should produce this file: <code>$MYINSTALL/lib/libmyjetanalysis.so</code></p>
<h2>Run this module</h2>
<p>To run this module, please insert this block of code in the Fun4All macro for your jet analysis: ```diff @ -20,6 +20,9 @ #include &lt;phpythia8/PHPythia8.h&gt; #include &lt;<a class="el" href="../../d5/db1/Fun4AllHepMCPileupInputManager_8h.html">phhepmc/Fun4AllHepMCPileupInputManager.h</a>&gt; #include &lt;<a class="el" href="../../d1/d72/Fun4AllHepMCInputManager_8h.html">phhepmc/Fun4AllHepMCInputManager.h</a>&gt;</p>
<ul>
<li>+#include &lt;myjetanalysis/MyJetAnalysis.h&gt;</li>
<li>#include "G4Setup_sPHENIX.C" #include "G4_Bbc.C" #include "G4_Global.C" @ -33,6 +36,8 @ R__LOAD_LIBRARY(libg4testbench.so) R__LOAD_LIBRARY(libphhepmc.so) R__LOAD_LIBRARY(libPHPythia6.so) R__LOAD_LIBRARY(libPHPythia8.so)</li>
<li><p class="startli">+R__LOAD_LIBRARY(libmyjetanalysis.so) #endif</p>
<p class="startli">using namespace std; @ -587,6 +592,11 @ int Fun4All_G4_sPHENIX( if (do_dst_compress) DstCompress(out); se-&gt;registerOutputManager(out); }</p>
</li>
<li></li>
<li>gSystem-&gt;Load("libmyjetanalysis");</li>
<li><a class="el" href="../../d5/d1f/classMyJetAnalysis.html">MyJetAnalysis</a> *myJetAnalysis = new <a class="el" href="../../d5/d1f/classMyJetAnalysis.html">MyJetAnalysis</a>("AntiKt_Tower_r04","AntiKt_Truth_r04","myjetanalysis.root");</li>
<li>se-&gt;registerSubsystem(myJetAnalysis);</li>
<li>//--------------&mdash; // <a class="el" href="../../d5/da5/classEvent.html">Event</a> processing //--------------&mdash;</li>
</ul>
<p>``` Furthermore, here is a full set of example macro to run this analysis module by analyzing PYTHIA8 jet event simulated in the same process: <a href="https://github.com/blackcathj/macros/blob/my-jet-analysis/macros/g4simulations/Fun4All_G4_sPHENIX.C">https://github.com/blackcathj/macros/blob/my-jet-analysis/macros/g4simulations/Fun4All_G4_sPHENIX.C</a></p>
<h2>Check the output</h2>
<p>The main output file is <code>myjetanalysis.root</code>, which contains ``` root [1] .ls TFile** myjetanalysis.root TFile* myjetanalysis.root KEY: TH1F hInclusive_E;1 AntiKt_Tower_r04 inclusive jet E KEY: TH1F hInclusive_eta;1 AntiKt_Tower_r04 inclusive jet #eta KEY: TH1F hInclusive_phi;1 AntiKt_Tower_r04 inclusive jet <a class="el" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a> KEY: TTree T;1 <a class="el" href="../../d5/d1f/classMyJetAnalysis.html">MyJetAnalysis</a> Tree ``` The T tree contains one entry per reconstructed jet. Here is its first entry: ``` root [2] T-&gt;Show(0) ======&gt; EVENT:0 event = 0 &lt;- event number id = 49 &lt;- jet ID in this event nComponent = 51 &lt;- number of component in reco jet, i.e. # of towers in jet eta = 0.3255 &lt;- jet psuedorapidity phi = -1.43342 &lt;- jet phi e = 19.4207 &lt;- jet energy pt = 18.2251 &lt;- jet pT truthID = 0 &lt;- If matched with a truth jet, the truth jet's ID truthNComponent = 1 &lt;- If matched with a truth jet, the truth jet's number of component truthEta = 0.348408 &lt;- If matched with a truth jet, the truth jet's eta truthPhi = -1.42448 &lt;- If matched with a truth jet, the truth jet's phi truthE = 32.0003 &lt;- If matched with a truth jet, the truth jet's energy truthPt = 30.1514 &lt;- If matched with a truth jet, the truth jet's pT nMatchedTrack = 1 &lt;- Number of track that matched with the jet trackdR = 0.00869318 &lt;- Distance of track and jet in eta-phi space, an array with size of [nMatchedTrack] trackpT = 30.4937 &lt;- Track's pT, an array with size of [nMatchedTrack] ```</p>
<h2>Make this your module</h2>
<p>Please copy this folder to a new folder under your local <a href="https://github.com/sPHENIX-Collaboration/analysis">analysis repository</a> and change package and class names. Welcome to edit it for your analysis cases.</p>
<p>Please upload your analysis module back to the <a href="https://github.com/sPHENIX-Collaboration/analysis">analysis repository</a> at the end too so it could be shared with others.</p>
<h1>Read more</h1>
<p>Many next-step topics are listed in the <a href="https://wiki.bnl.gov/sPHENIX/index.php/Software">software</a> page. And specifically, to use the simulation for your study, a few thing you might want to try:</p>
<ul>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/Example_of_using_DST_nodes">More on write your analysis module for more dedicated analysis</a>,</li>
<li>Examples to use evaluators of track, caloiemter, and jets in your analysis module (<a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/dd/d59/classCaloEvaluator.html">CaloEvaluator</a>, <a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/d1/df4/classJetEvaluator.html">JetEvaluator</a>, <a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/d6/d11/classSvtxEvaluator.html">SvtxEvaluator</a>). Welcome to copy and resuse blocks of the code from them.</li>
</ul>
<p>This directory contains 2 examples to create your own TTree using a class (and Fun4All). The sources are in ./src, the macros to run the show are in ./macros.</p>
<p>The <a class="el" href="../../d8/d07/classMySimpleTree.html">MySimpleTree</a> class is stored in a TTree by itself and then inside a TClonesArray (just to show you that the <a class="el" href="../../d8/d07/classMySimpleTree.html">MySimpleTree</a> class doesn't need any modifications for the TClonesArray).</p>
<p>Unlike our DST's there is no virtual base class to keep old files readable after you change the content of your class. It's not difficult to add this feature but I wanted to keep it straight and simple.</p>
<p>Library build: Don't build the library in the source area - it can be done but you do not do yourself any favors with this. Create a build area and think of an install area location (the install area will be created during "make install", you need to have write access). Go to the build area and</p>
<p>&lt;srcdir&gt;/autogen.sh &ndash;prefix=&lt;install area&gt; make install</p>
<p>To run the macros you have to add your install area to the LD_LIBRARY_PATH and to the ROOT_INCLUDE_PATH (where root6 looks for includes mentioned in the macro). For the ROOT_INCLUDE_PATH we have a setup script which will add your install area but also the includes in OFFLINE_MAIN (and G4 and <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a>).</p>
<p>setenv LD_LIBRARY_PATH &lt;install area&gt;/lib:$LD_LIBRARY_PATH source /opt/sphenix/core/bin/setup_root6.csh &lt;install area&gt;</p>
<p>With these settings you can run the macros in the macro directory.</p>
<p>This tutorial respository carries a few example cases of analysis for <a href="https://www.sphenix.bnl.gov/">sPHENIX collaboration</a>.</p>
<ul>
<li>Generators<ul>
<li><b>eventgenerator_display</b>: Display the output of our event generators in an empty world</li>
</ul>
</li>
<li>Simulation setups<ul>
<li><b>block</b>: build a simple block-shaped detector in Geant4</li>
<li><b>cylinder</b>: build a simple cylinder-shaped detector in Geant4</li>
</ul>
</li>
<li>Simulation checks<ul>
<li><b>materialscan</b>: scan radiation and hadronic interaction length in <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> command prompt</li>
<li><b><a class="el" href="../../d4/dc9/classPHG4DSTReader.html" title="PHG4DSTReader save information from DST to an evaluator, which could include hit. particle...">PHG4DSTReader</a></b>: poke at simulation results with <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> command lines. For official analysis please use analysis module such as the next a few items below</li>
</ul>
</li>
<li>Example analysis modules<ul>
<li><b><a class="el" href="../../d0/da9/classAnaTutorial.html" title="Definition of this analysis module class.">AnaTutorial</a></b>: analysis tutorial with compiled module processing track, clusters and jets. See <a href="https://indico.bnl.gov/event/7254/">Recording and slides by Joe Osborn</a>.</li>
<li><b>MyOwnTTree</b>: two examples to create your own TTree using analysis module in the Fun4All framework</li>
<li><b>myjetanalysis</b>: example to analysis jet and to perform jet fragmentation and jet shape analysis</li>
<li><b><a class="el" href="../../dd/d0c/classCaloAna.html">CaloAna</a></b>: example to fetch calorimeter hit, tower and clusters and save to a NTuple</li>
</ul>
</li>
<li><b>JupyterLab</b>: run the sPHENIX anaysis on the <a href="https://jupyter.sdcc.bnl.gov/">BNL SDCC Jupyter Lab web interface</a>.</li>
</ul>
<h1>Useful links</h1>
<ul>
<li>Tutorials<ul>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/SPHENIX_software_day-1_checklist">Get started on day-1</a></li>
<li><a href="https://indico.bnl.gov/event/7254/">Most recent tutorial session</a></li>
</ul>
</li>
<li>Documentation<ul>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/Software">Software wiki</a></li>
<li><a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/">Doxygen: easier way to browse code</a></li>
<li><a href="https://wiki.bnl.gov/sPHENIX/index.php/Example_of_using_DST_nodes#Building%20a%20package">Build a package</a></li>
</ul>
</li>
<li>Communication<ul>
<li><a href="https://indico.bnl.gov/categoryDisplay.py?categId=88">Simulation and software meeting series</a></li>
<li><a href="https://lists.bnl.gov/mailman/listinfo/sphenix-github-l">Discussion on this repository</a></li>
</ul>
</li>
</ul>
<p><a href="https://www.sphenix.bnl.gov/">![logo](https://avatars3.githubusercontent.com/u/12069843?s=200&amp;v=4)</a></p>
<p><a href="https://web.racf.bnl.gov/jenkins-sphenix/job/sPHENIX/job/sPHENIX_CoreSoftware_MasterBranch/">![Build Status](https://web.racf.bnl.gov/jenkins-sphenix/buildStatus/icon?job=sPHENIX/sPHENIX_CoreSoftware_MasterBranch)</a> <a href="https://www.phenix.bnl.gov/WWW/sPHENIX/doxygen/html/">![Doxygen](https://img.shields.io/badge/code%20reference-Doxygen-green.svg)</a></p>
<p><a href="https://github.com/sPHENIX-Collaboration/prototype/issues">![Open Issues](https://img.shields.io/github/issues/sPHENIX-Collaboration/prototype.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/prototype/pulls">![Open Pull Request](https://img.shields.io/github/issues-pr/sPHENIX-Collaboration/prototype.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/prototype/commits/master">![Monthly Commits](https://img.shields.io/github/commit-activity/m/sPHENIX-Collaboration/prototype.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/prototype/commits/master">![Last Commit](https://img.shields.io/github/last-commit/sPHENIX-Collaboration/prototype.svg)</a> <a href="https://github.com/sPHENIX-Collaboration/prototype/archive/master.zip">![Download size](https://img.shields.io/github/languages/code-size/sPHENIX-Collaboration/prototype.svg)</a></p>
<p>Collection of reconstruction modules and macros for sPHENIX prototypes. The code management model follow that of the <a href="https://github.com/sPHENIX-Collaboration/coresoftware">sPHENIX coresoftware</a>. And these codes are separated from the <code>coresoftware</code> as they have distinct life cycle to fit the test beam analysis. <hr/>
<p><a href="https://www.sphenix.bnl.gov/">![logo](https://raw.githubusercontent.com/sPHENIX-Collaboration/utilities/master/jenkins/material/sphenix-logo-white-bg-72p.png)</a></p>
<p><a href="https://travis-ci.org/GenFit/GenFit">![Build Status](https://travis-ci.org/GenFit/GenFit.svg?branch=master)</a></p>
<h1>GenFit Package</h1>
<p>GenFit is an experiment-independent framework for track reconstruction for particle and nuclear physics. It consists of three modular components:</p>
<ul>
<li><p class="startli">Track fitting algorithms</p>
<p class="startli">Currently, GENFIT contains a Kalman Filter, a Deterministic Annealing Filter, and a General Broken Lines fitter. Other algorithm modules can be added easily.</p>
</li>
</ul>
<ul>
<li><p class="startli">Track representations</p>
<p class="startli">These modules can perform extrapolations of track parameters through material and magnetic fields. GENFIT is distributed with a well-tested track representation. Existing track extrapolation codes can be interfaced in a very straightforward way in this framework, using their native geometry and magnetic field interfaces.</p>
</li>
</ul>
<ul>
<li><p class="startli">Measurements</p>
<p class="startli">The measurement dimensionality and the orientation of planar tracking detectors can be chosen freely. GENFIT is especially useful for tracking systems which include detectors which do not measure the passage of particles on predefined planes, like TPCs or wire-based drift chambers. The concept of so-called virtual detector planes provides a simple mechanism to use these detector hits in a transparent way without any geometrical simplifications.</p>
</li>
</ul>
<p>GenFit has been developed in the framework of the PANDA experiment at FAIR, Darmstadt, Germany. It is also used in the Belle-2, Fopi, and GEM-TPC experiments.</p>
<p>GenFit Homepage: (<a href="https://github.com/GenFit/GenFit">https://github.com/GenFit/GenFit</a>) </p>
</div></div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath">
	<!-- id is needed for treeview function! -->
	<ul>
		<li class="footer">
		Built by <a href="mailto:jhuang@bnl.gov">Jin Huang</a></em>.
			updated: <em>Mon Feb 17 2020 04:18:43</em> using <a
			href="http://www.doxygen.org/index.html"> <img class="footer"
				src="../../doxygen.png" alt="doxygen" /></a> 1.8.2 
				with <a href="https://github.com/sPHENIX-Collaboration">sPHENIX GitHub integration</a>
		</li>
	</ul>
</div>
</body>
</html>
